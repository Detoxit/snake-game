<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ó–º–µ–π–∫–∞</title>
  <style>
    body {
      margin: 0;
      background-color: #111;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: sans-serif;
      color: white;
    }

    canvas {
      background-color: #222;
      border: 2px solid #fff;
      display: none; /* —Å–∫—Ä—ã—Ç–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞ */
    }

    #score {
      position: absolute;
      top: 20px;
      text-align: center;
      width: 100%;
      font-size: 24px;
      font-weight: bold;
    }

    #startScreen {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      text-align: center;
    }

    #startBtn {
      padding: 15px 30px;
      font-size: 20px;
      background-color: #0f0;
      color: #000;
      border: none;
      cursor: pointer;
      border-radius: 8px;
      transition: background 0.3s;
    }

    #startBtn:hover {
      background-color: #6f6;
    }
  </style>
</head>
<body>

  <div id="startScreen">
    <h1>–ó–º–µ–π–∫–∞</h1>
    <button id="startBtn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
  </div>

  <div id="score">–°—á—ë—Ç: 0</div>
  <canvas id="game" width="400" height="400"></canvas>

  <script>
    const startScreen = document.getElementById("startScreen");
    const startBtn = document.getElementById("startBtn");
    const scoreEl = document.getElementById("score");
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const box = 20; // —Ä–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏
    const rows = canvas.height / box;
    const cols = canvas.width / box;

    let score = 0;
    let direction = "";
    let gameInterval;
    let snake = [];
    let food = {};

    function initGame() {
      // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
      startScreen.style.display = "none";
      canvas.style.display = "block";

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–º–µ–π–∫–∏ –∏ –µ–¥—ã
      snake = [{ x: 9 * box, y: 9 * box }];
      food = {
        x: Math.floor(Math.random() * cols) * box,
        y: Math.floor(Math.random() * rows) * box
      };
      score = 0;
      direction = "RIGHT";
      scoreEl.innerText = "–°—á—ë—Ç: " + score;

      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
      document.addEventListener("keydown", changeDirection);

      // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
      if (gameInterval) clearInterval(gameInterval);
      gameInterval = setInterval(draw, 250); // üö¶ –ó–∞–º–µ–¥–ª–∏–ª–∏ –¥–æ 150 –º—Å
    }

    function changeDirection(event) {
      if (event.key === "ArrowLeft" && direction !== "RIGHT") direction = "LEFT";
      else if (event.key === "ArrowUp" && direction !== "DOWN") direction = "UP";
      else if (event.key === "ArrowRight" && direction !== "LEFT") direction = "RIGHT";
      else if (event.key === "ArrowDown" && direction !== "UP") direction = "DOWN";
    }

    function draw() {
      // –§–æ–Ω
      ctx.fillStyle = "#222";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // –†–∏—Å—É–µ–º –∑–º–µ–π–∫—É
      for (let i = 0; i < snake.length; i++) {
        ctx.fillStyle = i === 0 ? "#0f0" : "#0a0";
        ctx.fillRect(snake[i].x, snake[i].y, box, box);
      }

      // –†–∏—Å—É–µ–º –µ–¥—É
      ctx.fillStyle = "#f00";
      ctx.fillRect(food.x, food.y, box, box);

      // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã
      let headX = snake[0].x;
      let headY = snake[0].y;

      if (direction === "LEFT") headX -= box;
      if (direction === "RIGHT") headX += box;
      if (direction === "UP") headY -= box;
      if (direction === "DOWN") headY += box;

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
      if (
        headX < 0 || headX >= canvas.width ||
        headY < 0 || headY >= canvas.height ||
        collision(headX, headY, snake)
      ) {
        clearInterval(gameInterval);
        alert("–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –°—á—ë—Ç: " + score);
        location.reload(); // –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∏–≥—Ä—ã
        return;
      }

      // –ù–æ–≤–æ–µ —è–±–ª–æ–∫–æ
      if (headX === food.x && headY === food.y) {
        score++;
        scoreEl.innerText = "–°—á—ë—Ç: " + score;
        food = {
          x: Math.floor(Math.random() * cols) * box,
          y: Math.floor(Math.random() * rows) * box
        };
      } else {
        snake.pop();
      }

      // –ù–æ–≤–∞—è –≥–æ–ª–æ–≤–∞
      const newHead = { x: headX, y: headY };
      snake.unshift(newHead);
    }

    function collision(x, y, array) {
      for (let i = 0; i < array.length; i++) {
        if (array[i].x === x && array[i].y === y) {
          return true;
        }
      }
      return false;
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ä—Ç–∞
    startBtn.addEventListener("click", () => {
      initGame();
    });
  </script>
</body>
</html>